[gd_scene load_steps=15 format=3 uid="uid://ckcc3w7belxeq"]

[ext_resource type="PackedScene" uid="uid://o4fwaans2v2h" path="res://node/3d_metal_direction_block.tscn" id="1_en680"]
[ext_resource type="PackedScene" uid="uid://03o5rhuax2e8" path="res://node/3d_tile.tscn" id="2_yg6wn"]
[ext_resource type="Shader" uid="uid://bbw87eq28j0vo" path="res://shaders/3d_stencil_shader.gdshader" id="3_t2s5x"]
[ext_resource type="Texture2D" uid="uid://cbg3yhyf2y2kb" path="res://assets/vertical_shine.png" id="4_lxxwu"]
[ext_resource type="Script" uid="uid://doywv1xgdy1k4" path="res://scripts/drag_direction_manager.gd" id="5_80qfw"]
[ext_resource type="Script" uid="uid://bx6o5aumpykia" path="res://scripts/action_taker.tres.gd" id="6_442nf"]
[ext_resource type="PackedScene" uid="uid://cp2egv33ck3if" path="res://node/input_effect.tscn" id="7_pqs06"]
[ext_resource type="Texture2D" uid="uid://bg2schsha0cid" path="res://assets/arrow.png" id="8_c0xwg"]
[ext_resource type="Script" uid="uid://bhjy45nqkx5ke" path="res://scripts/map_get.gd" id="9_yg6wn"]

[sub_resource type="Environment" id="Environment_t4uy4"]
background_mode = 1
ambient_light_source = 2

[sub_resource type="PlaneMesh" id="PlaneMesh_uqnsk"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_deqta"]
render_priority = 0
shader = ExtResource("3_t2s5x")
shader_parameter/offset = 1.3
shader_parameter/shine_texture = ExtResource("4_lxxwu")
shader_parameter/zoomout = 5.0

[sub_resource type="GDScript" id="GDScript_gyhtd"]
script/source = "@tool
extends MeshInstance3D

@export var shader : ShaderMaterial

var offset = 0.0
@export var shine_curve : Curve

func _physics_process(delta: float) -> void:
	offset += delta / 10
	offset = fmod(offset, 1.0)
	shader.set_shader_parameter(\"offset\", shine_curve.sample(offset) + .3)
"

[sub_resource type="Curve" id="Curve_gyhtd"]
_data = [Vector2(0, 0), 0.0, 0.021993779, 0, 0, Vector2(0.07608695, 1), 3.2080586, 0.0, 0, 0]
point_count = 2

[node name="Node3D" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_t4uy4")

[node name="DeadLight" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 7.8951397, 0)
light_energy = 0.0

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4.529915, 0)
shadow_enabled = true
shadow_blur = 10.0
omni_range = 7.7442045

[node name="OmniLight3D2" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4.529915, 0)
shadow_blur = 10.0
omni_range = 10.873977

[node name="GameWorld" type="Node3D" parent="."]

[node name="Blocks" type="Node3D" parent="GameWorld"]

[node name="Block" parent="GameWorld/Blocks" instance=ExtResource("1_en680")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0)

[node name="Block2" parent="GameWorld/Blocks" instance=ExtResource("1_en680")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0, 0)

[node name="Block3" parent="GameWorld/Blocks" instance=ExtResource("1_en680")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0, -1)

[node name="Block4" parent="GameWorld/Blocks" instance=ExtResource("1_en680")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -3)

[node name="Floor" type="Node3D" parent="GameWorld"]

[node name="Tile" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -4)

[node name="Tile2" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, -4)

[node name="Tile3" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, -4)

[node name="Tile7" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -12)

[node name="Tile8" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, -12)

[node name="Tile9" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, -12)

[node name="Tile10" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 12)

[node name="Tile11" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 12)

[node name="Tile12" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, 12)

[node name="Tile4" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 4)

[node name="Tile5" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 4)

[node name="Tile6" parent="GameWorld/Floor" instance=ExtResource("2_yg6wn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, 4)

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 10.824222, 0)
projection = 1
size = 13.426387

[node name="Shine" type="MeshInstance3D" parent="Camera3D"]
transform = Transform3D(20, 0, 0, 0, -4.371139e-07, -10, 0, 10, -4.371139e-07, 0.014985442, 0.001152338, -1.3968601)
mesh = SubResource("PlaneMesh_uqnsk")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("ShaderMaterial_deqta")
script = SubResource("GDScript_gyhtd")
shader = SubResource("ShaderMaterial_deqta")
shine_curve = SubResource("Curve_gyhtd")

[node name="CamArm" type="Node3D" parent="."]
transform = Transform3D(0.9999999, 0, 0, 0, 0.9999999, 0, 0, 0, 0.9999999, 0, 0, 0)

[node name="DragDirectionManager" type="Node" parent="." node_paths=PackedStringArray("action_taker", "cam_arm")]
script = ExtResource("5_80qfw")
action_taker = NodePath("../ActionTaker")
cam_arm = NodePath("../CamArm")

[node name="ActionTaker" type="Node3D" parent="." node_paths=PackedStringArray("camera", "map_get")]
script = ExtResource("6_442nf")
input_effect_packed = ExtResource("7_pqs06")
camera = NodePath("../Camera3D")
drag_ie_texture = ExtResource("8_c0xwg")
map_get = NodePath("../MapGet")

[node name="MapGet" type="Node3D" parent="." node_paths=PackedStringArray("game_world", "block_holder")]
script = ExtResource("9_yg6wn")
game_world = NodePath("../GameWorld")
block_holder = NodePath("../GameWorld/Blocks")
